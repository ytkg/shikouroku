# プロダクト機能拡張ロードマップ

- 更新日: 2026-02-26
- 対象: `apps/web` / `apps/api`
- 種別: ロードマップ

## 1. 方針

- 優先軸は「継続利用率」と「再訪のしやすさ」。
- 現フェーズは「記録しやすい」「見返しやすい」「整理し続けられる」を順に強化する。

## 2. やったこと（実装済み）

- [x] 認証、entity CRUD、タグ管理
- [x] 関連嗜好（表示/追加/解除）
- [x] 画像添付（一覧/追加/削除/並び替え/プレビュー）
- [x] 画像削除補償キュー（手動実行 + cron）
- [x] 一覧検索/絞り込み（`kindId` / `wishlist` / `q` / `match` / `fields`）とページング
- [x] 位置情報付き entity の登録/更新（緯度経度）
- [x] 地図ページ（`/map`）での表示、タグ/名前フィルタ、詳細モーダル表示
- [x] API 共通契約の統一（`{ ok, ...payload, requestId }` / `{ ok: false, error, requestId }`）

## 3. やること（優先バックログ）

### 3.1 [ ] P0: 振り返りホーム

- 目的
  - ログイン直後に「次に見るべき記録」を提示し、再訪行動を作る。
- 追加要素
  - 最近追加
  - 最近更新
  - 気になる（wishlist）未解消
  - 位置情報付きで未確認の記録
- 受け入れ基準
  - ホーム経由の詳細遷移率が現状より改善する。

### 3.2 [ ] P0: リマインド（見返し日）

- 目的
  - 記録後の再編集サイクルを作る。
- 追加要素
  - `entities.review_at` を追加
  - 期限到来項目をホームで表示
- 受け入れ基準
  - 当日以前の見返し対象をホームで見落とさない。

### 3.3 [ ] P1: タグ運用強化（rename/merge）

- 目的
  - 長期利用で発生する重複・表記ゆれを解消する。
- 追加要素
  - `PATCH /api/tags/:id`（rename）
  - `POST /api/tags/:id/merge`（merge）
- 受け入れ基準
  - merge 後に関連付けが完全に統合される。

### 3.4 [ ] P1: アーカイブ管理

- 目的
  - データ増加時の一覧可読性を維持する。
- 追加要素
  - `entities.archived_at` を追加
  - 通常一覧から除外、アーカイブ一覧で再表示
- 受け入れ基準
  - アーカイブ前提でも通常一覧の探索速度が落ちない。

### 3.5 [ ] P2: エクスポート

- 目的
  - 可搬性を担保し、利用継続の心理的障壁を下げる。
- 追加要素
  - `GET /api/export.json`
  - entity, tag, relation, image metadata, location を出力
- 受け入れ基準
  - 出力データのみでドメイン構造を再構築できる。

## 4. 実装順序

1. 振り返りホーム
2. リマインド（見返し日）
3. タグ運用強化（rename/merge）
4. アーカイブ管理
5. エクスポート

## 5. KPI（追跡候補）

- 7日継続率
- セッションあたり詳細遷移数
- 週次再編集率
- 見返し期限到来項目の消化率
- 地図ページ経由の詳細遷移率
- タグ重複率

## 6. 補足

- 本ドキュメントは計画管理用であり、実装仕様の正は各 feature spec / architecture guide を参照する。
- 外部通知（メール/Push）とインポート機能は現フェーズ対象外。
